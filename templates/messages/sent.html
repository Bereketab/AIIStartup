{% extends '../logged_user/base.html'%} {% block content %}
{% include '../logged_user/header.html' %}
{%load static %}
{% load getUser %}
{% load humanize %}
<!-- ======= Breadcrumbs ======= -->
<div class="breadcrumbs">
  <div class="container"></div>
</div>
<!-- End Breadcrumbs -->

<!-- ======= Blog Section ======= -->
<!-- WAnbehagerlij126 -->
<div class="container py-5">

  <div class="row">

    <div class="col-md-6 col-lg-5 col-xl-4 mb-4 mb-md-0">

      <h5 class="font-weight-bold mb-3 text-center text-lg-start">messages</h5>

      <div class="card">
        <div class="card-body">

          <ul class="list-unstyled mb-0">


            {% for c in my_inbox %}
           
            <li class="p-2 border-bottom" style="{%if c.recipient_ids|isSent request.user %} background-color: #eee; {%else%} background-color: #2234; {%endif%}">
              <a class="d-flex justify-content-between">
                <div class="d-flex flex-row">
                 
                

                  <img src="{{ c.sender.id|getSenderPic }}" alt="avatar"
                    class="rounded-circle d-flex align-self-center me-2 shadow-1-strong" width="30"
                    title="{{ c.sender.username }}">

                  <div class="pt-1">
                    <p class="small text-muted">{{ c.message }}  {{c.is_sent}}</p>
                  </div>

                </div>
                <div class="pt-1">
                  <p class="small text-muted mb-1">{{ c.creation_date|naturaltime }}</p>
                  <span class="badge bg-danger float-end">1</span>
                </div>
              </a>
            </li>


            {% endfor %}

          </ul>

        </div>
      </div>

    </div>

<!-- 2,10,11,12 -->
  </div>

</div>
<script src="https://code.jquery.com/jquery-3.6.0.js"></script>
<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>

<script>

// console.log($("[name='recivers']")[0].id)
  let loginForm = document.getElementById("message_form");
  loginForm.addEventListener("submit", (e) => {
    e.preventDefault();

    const message = $('#textAreaExample2').val();
     $.ajax({
      headers: { "X-CSRFToken":  '{{ csrf_token }}' },
      url: {% url 'main:sentMessagefromDetail'  %},
      data: {sender:$("[name='sender']")[0].id,recievers:$("[name='recivers']")[0].id,"message":message},
      type: "POST",
      success: function (data) {
       $('#textAreaExample2').val('');
        window.location.reload()
      
      },
      error: function (data) {
      }
    });
  });


</script>
{% endblock content%}